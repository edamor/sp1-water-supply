(this["webpackJsonpwater-bill-mgmt-w-sms"]=this["webpackJsonpwater-bill-mgmt-w-sms"]||[]).push([[0],{31:function(e,t,c){},37:function(e,t,c){},38:function(e,t,c){},39:function(e,t,c){},40:function(e,t,c){},41:function(e,t,c){},42:function(e,t,c){},44:function(e,t,c){},45:function(e,t,c){},46:function(e,t,c){},47:function(e,t,c){},48:function(e,t,c){"use strict";c.r(t);var a=c(0),s=c(1),n=c.n(s),l=c(23),r=c.n(l),i=(c(31),c(4)),o=c(5),d=c(3),b=c(16);function j(e){var t=e.children,c=Object(b.a)(e,["children"]),s=!!localStorage.getItem("token");return Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(o.b,Object(d.a)(Object(d.a)({},c),{},{render:function(e){var c=e.location;return s?t:Object(a.jsx)(o.a,{to:{pathname:"/login",state:{from:c}}})}}))})}c(37);var m=c(2),u=function(e){var t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),c=decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(c)},h=function(){var e=Object(o.g)(),t=Object(s.useRef)(!0),c=Object(s.useRef)(!0),n=Object(s.useState)(""),l=Object(m.a)(n,2),r=l[0],i=l[1],d=Object(s.useState)(""),b=Object(m.a)(d,2),j=b[0],h=b[1],O=Object(s.useState)(!1),x=Object(m.a)(O,2),p=x[0],f=x[1],N=function(){f(!0);var a={username:r,password:j};fetch("https://sp1-blue-sparrow.herokuapp.com/auth/admin/login",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(a)}).then((function(e){return e.text()})).then((function(a){console.log(a),"Invalid Username"===a||"Incorrect Password"===a||"Login Invalid"===a?(alert(a),f(!1),t.current.value="",c.current.value=""):(localStorage.setItem("token",a),localStorage.setItem("role",u(a).role),e.push("/"))})).catch((function(e){console.log(e),alert("Something went wrong..."),f(!1)}))};return Object(a.jsxs)("div",{className:"",children:[Object(a.jsxs)("div",{className:"col-12 mb-4",children:[Object(a.jsx)("label",{htmlFor:"usernameInput",className:"form-label",children:"Username"}),Object(a.jsx)("input",{type:"text",className:"form-control",id:"usernameInput",placeholder:"Username",ref:t,onChange:function(e){i(e.target.value.trim())},disabled:p})]}),Object(a.jsxs)("div",{className:"col-12 mb-4",children:[Object(a.jsx)("label",{htmlFor:"adminPwInput",className:"form-label",children:"Password"}),Object(a.jsx)("input",{type:"password",className:"form-control",id:"adminPwInput",placeholder:"Password",ref:c,onChange:function(e){h(e.target.value.trim())},disabled:p})]}),Object(a.jsx)("div",{className:"col-12 mb-3 pt-2",children:p?Object(a.jsxs)("button",{type:"button",className:"btn btn-primary w-100",disabled:p,children:[Object(a.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(a.jsx)("span",{className:"visually-hidden",children:"Loading..."})]}):Object(a.jsx)("button",{type:"button",className:"btn btn-primary w-100",onClick:N,children:Object(a.jsx)("span",{children:"Login"})})})]})},O=Object(s.createContext)(),x=function(e){var t=e.children,c=Object(s.useState)(!0),n=Object(m.a)(c,2),l=n[0],r=n[1];return Object(a.jsx)(O.Provider,{value:{activeUser:l,setActiveUser:r},children:t})},p=function(){var e=Object(o.g)(),t=Object(s.useRef)(!0),c=Object(s.useRef)(!0),n=Object(s.useState)(""),l=Object(m.a)(n,2),r=l[0],i=l[1],d=Object(s.useState)(""),b=Object(m.a)(d,2),j=b[0],h=b[1],x=Object(s.useContext)(O).setActiveUser,p=Object(s.useState)(!1),f=Object(m.a)(p,2),N=f[0],v=f[1],g=function(){v(!0);var a={username:r,password:j};fetch("https://sp1-blue-sparrow.herokuapp.com/auth/customer/login",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(a)}).then((function(e){return e.text()})).then((function(a){console.log(a),"Invalid Username"===a||"Incorrect Password"===a||"Login Invalid"===a?(alert(a),v(!1),t.current.value="",c.current.value=""):(localStorage.setItem("token",a),localStorage.setItem("role",u(a).role),x(u(a).account),e.push("/"))})).catch((function(e){console.log(e),alert("Something went wrong..."),v(!1)}))};return Object(a.jsxs)("div",{className:"",children:[Object(a.jsxs)("div",{className:"col-12 mb-4",children:[Object(a.jsx)("label",{htmlFor:"accountNumberInput",className:"form-label",children:"Account No."}),Object(a.jsx)("input",{type:"text",className:"form-control",id:"accountNumberInput",placeholder:"Account No.",ref:t,onChange:function(e){i(e.target.value.trim())}})]}),Object(a.jsxs)("div",{className:"col-12 mb-4",children:[Object(a.jsx)("label",{htmlFor:"customerPwInput",className:"form-label",children:"Password"}),Object(a.jsx)("input",{type:"password",className:"form-control",id:"customerPwInput",placeholder:"Password",ref:c,onChange:function(e){h(e.target.value.trim())}})]}),Object(a.jsx)("div",{className:"col-12 mb-3 pt-2",children:N?Object(a.jsxs)("button",{type:"button",className:"btn btn-primary w-100",disabled:N,children:[Object(a.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(a.jsx)("span",{className:"visually-hidden",children:"Loading..."})]}):Object(a.jsx)("button",{type:"button",className:"btn btn-primary w-100",onClick:g,children:Object(a.jsx)("span",{children:"Login"})})})]})},f=c.p+"static/media/alcantara-seal.a1037ced.png",N=function(){var e=window.innerWidth;return Object(a.jsx)(a.Fragment,{children:Object(a.jsx)("div",{className:"container sign-in-wrapper ",children:Object(a.jsxs)("div",{className:"row h-100 d-flex align-items-center justify-content-center",children:[Object(a.jsxs)("div",{className:"col-12 col-md-6 ",children:[Object(a.jsx)("div",{className:"text-center",children:Object(a.jsx)("img",{src:f,alt:"Alcantara, Romblon - Municipal Seal",className:"img-thumbnail border-0",style:{height:"".concat(e<576?"7rem":"12rem"),width:"".concat(e<576?"7rem":"12rem")}})}),Object(a.jsx)("p",{className:"display-6 text-center",children:"Municipality of Alcantara"}),Object(a.jsx)("p",{className:"h3 text-center",children:"Water Supply System"})]}),Object(a.jsxs)("div",{className:"col-12 col-md-6",children:[Object(a.jsx)("p",{className:"mr-auto h4",children:"Login As:"}),Object(a.jsxs)("ul",{className:"nav nav-tabs pt-1",id:"myTab",role:"tablist",children:[Object(a.jsx)("li",{className:"nav-item",role:"presentation",children:Object(a.jsx)("a",{className:"nav-link active",id:"home-tab","data-toggle":"tab",href:"#admin",role:"tab","aria-controls":"admin","aria-selected":"true",children:"Admin"})}),Object(a.jsx)("li",{className:"nav-item",role:"presentation",children:Object(a.jsx)("a",{className:"nav-link",id:"customer-tab","data-toggle":"tab",href:"#customer",role:"tab","aria-controls":"customer","aria-selected":"false",children:"Customer"})})]}),Object(a.jsxs)("div",{className:"tab-content col-12 flex-column p-3 border border-1",id:"myTabContent",children:[Object(a.jsx)("div",{className:"tab-pane fade show active",id:"admin",role:"tabpanel","aria-labelledby":"admin-tab",children:Object(a.jsx)(h,{})}),Object(a.jsx)("div",{className:"tab-pane fade",id:"customer",role:"tabpanel","aria-labelledby":"customer-tab",children:Object(a.jsx)(p,{})})]})]})]})})})},v=(c(38),function(e){var t=Object(o.g)(),c=localStorage.getItem("role"),s=[{name:"Home",to:{pathname:"/admin",state:{from:t.location}}},{name:"Accounts",subMenu:[{name:"View Accounts",to:{pathname:"/admin/accounts",state:{from:t.location}}},{name:"Register Account",to:{pathname:"/admin/accounts/new",state:{from:t.location}}}]},{name:"Statements",to:{pathname:"/admin/statements",state:{from:t.location}}}],n={pathname:"/customer",state:{from:t.location}},l={pathname:"/customer/bills",state:{from:t.location}};function r(){e.signOut(!0)}var d;return Object(a.jsx)("nav",{className:"navbar navbar-expand-lg navbar-light fixed-top bg-light",children:Object(a.jsxs)("div",{className:"container-fluid",children:[Object(a.jsxs)("div",{children:[Object(a.jsx)("span",{className:"mr-1 navbar-brand",children:"Water"}),Object(a.jsx)("span",{className:"mr-1 navbar-brand",children:"Supply"}),Object(a.jsx)("span",{className:"mr-1 navbar-brand",children:"System"})]}),Object(a.jsx)("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNavAltMarkup","aria-controls":"navbarNavAltMarkup","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(a.jsx)("span",{className:"navbar-toggler-icon"})}),(d=c,"admin"===d?Object(a.jsxs)("div",{className:"collapse navbar-collapse",id:"navbarNavAltMarkup",children:[Object(a.jsxs)("div",{className:"navbar-nav d-flex w-75",children:[s.map((function(e){return"Accounts"===e.name?Object(a.jsxs)("div",{className:"nav-item dropdown",children:[Object(a.jsx)("button",{type:"button",className:"btn btn-link nav-link dropdown-toggle ","data-toggle":"dropdown","aria-expanded":"false",children:e.name}),Object(a.jsx)("div",{className:"dropdown-menu",children:e.subMenu.map((function(e){return Object(a.jsx)(i.b,{className:"nav-link dropdown-item ",activeClassName:"active",exact:!0,to:e.to,children:e.name},e.name)}))})]},e.name):Object(a.jsx)(i.b,{className:"nav-link ",activeClassName:"active",exact:!0,to:e.to,children:e.name},e.name)})),Object(a.jsx)(i.b,{className:"nav-link ",activeClassName:"active",exact:!0,to:{pathname:"/admin/reports",state:{from:t.location}},children:"Reports"})]}),Object(a.jsx)("div",{className:"d-flex w-100 w-md-75 justify-content-md-end justify-content-center",children:Object(a.jsx)("button",{type:"button",className:"btn btn-link sign-out-btn",onClick:r,children:"Sign Out"})})]}):Object(a.jsxs)("div",{className:"collapse navbar-collapse",id:"navbarNavAltMarkup",children:[Object(a.jsxs)("div",{className:"navbar-nav d-flex w-25 justify-content-around",children:[Object(a.jsx)(i.b,{className:"nav-link ",activeClassName:"active",exact:!0,to:n,children:"Account"}),Object(a.jsx)(i.b,{className:"nav-link ",activeClassName:"active",to:l,children:"Bills"})]}),Object(a.jsx)("div",{className:"d-flex w-100 w-md-75 justify-content-md-end justify-content-center",children:Object(a.jsx)("button",{type:"button",className:"btn btn-link sign-out-btn",onClick:r,children:"Sign Out"})})]}))]})})}),g=(c(39),function(e){return Object(a.jsx)("div",{className:"popup-notif-modal",onClick:function(t){t.target.classList.contains("popup-notif-modal")&&e.hide()},children:Object(a.jsx)("div",{className:"modal-dialog modal-sm modal-dialog-centered modal-fullscreen-md-down",children:Object(a.jsxs)("div",{className:"modal-content",children:[Object(a.jsxs)("div",{className:"modal-header",children:[Object(a.jsxs)("p",{className:"modal-title font-l",children:[" ",e.title," "]}),Object(a.jsx)("button",{type:"button",className:"btn-close","data-dismiss":"modal","aria-label":"Close",onClick:e.hide})]}),Object(a.jsxs)("div",{className:"modal-body",children:[e.loading&&Object(a.jsx)("div",{className:"d-flex justify-content-center",children:Object(a.jsx)("div",{className:"spinner-border",role:"status",children:Object(a.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}),!e.loading&&Object(a.jsxs)("p",{children:[" ",e.message," "]})]}),Object(a.jsxs)("div",{className:"modal-footer",children:[Object(a.jsx)("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal",onClick:e.hide,disabled:e.loading,children:"".concat("Success"!==e.title&&"Failed"!==e.title?"Cancel":"Close")}),"Success"!==e.title&&"Failed"!==e.title&&Object(a.jsx)("button",{type:"button",className:"btn btn-success",onClick:function(){e.confirmAction(e.refNumber)},disabled:e.loading,children:"Confirm"})]})]})})})}),y=Object(s.createContext)(),w=function(e){var t=e.children,c=Object(s.useState)(),n=Object(m.a)(c,2),l=n[0],r=n[1];return Object(a.jsx)(y.Provider,{value:{data:l,setData:r},children:t})},S=Object(s.createContext)(),C=function(e){var t=e.children,c=Object(s.useContext)(y),n=Object(s.useState)(c[0]),l=Object(m.a)(n,2),r=l[0],i=l[1];return Object(a.jsx)(S.Provider,{value:{billOnDisplay:r,setBillOnDisplay:i},children:t})},k=(c(40),function(e){var t=e.bill,c=new Date(t.periodFrom).toDateString().substring(4,10),s=new Date(t.periodTo).toDateString().substring(4,10),n=Object(o.g)();return Object(a.jsx)("div",{className:"container bill-card-wrapper",children:Object(a.jsx)("div",{className:"row pt-3",children:Object(a.jsx)("div",{className:"col-12 col-md-10 mx-auto",children:Object(a.jsxs)("div",{className:"card",children:[Object(a.jsx)("div",{className:"card-header",children:Object(a.jsxs)("div",{className:"row py-2",children:[Object(a.jsx)("div",{className:"col-12 col-md-2",children:Object(a.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(a.jsx)("p",{className:"h5",children:"Bill No."}),Object(a.jsxs)("p",{className:"h5 font-weight-normal",children:[" ","".concat(t.billNumber)," "]})]})}),Object(a.jsx)("div",{className:"col-12 col-md-5 ml-auto",children:Object(a.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(a.jsx)("p",{className:"h5",children:"Period Covered:"}),Object(a.jsx)("p",{className:"h5 font-weight-light",children:"".concat(c," - ").concat(s)})]})})]})}),Object(a.jsxs)("div",{className:"card-body",children:[Object(a.jsx)("div",{className:"row g-2",children:Object(a.jsxs)("div",{className:"col-6 p-2 m-auto",children:[Object(a.jsx)("p",{className:"h5 text-center",children:"Meter Reading"}),Object(a.jsxs)("div",{className:"d-flex justify-content-between my-0 py-0",children:[Object(a.jsx)("p",{className:"font-weight-bold my-0 py-0",children:"Present: "}),Object(a.jsxs)("p",{className:"my-0 py-0",children:[" ",t.readingPresent," "]})]}),Object(a.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(a.jsx)("p",{className:"font-weight-bold my-0 py-0",children:"Previous: "}),Object(a.jsxs)("p",{className:"my-0 py-0",children:[" ",t.readingPrevious," "]})]}),Object(a.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(a.jsx)("p",{className:"font-weight-bold my-0 py-0",children:"Used in Cu. Meters: "}),Object(a.jsxs)("p",{className:"my-0 py-0",children:[" ",t.cumUsed," "]})]})]})}),Object(a.jsx)("hr",{}),Object(a.jsxs)("div",{className:"row g-2",children:[Object(a.jsx)("p",{className:"h5 text-center",children:"Consumption"}),Object(a.jsxs)("div",{className:"col-8 m-auto",children:[Object(a.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(a.jsx)("p",{className:"font-weight-bold",children:"Charges"}),Object(a.jsx)("p",{className:"font-weight-bold",children:"Rates"})]}),Object(a.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(a.jsx)("p",{className:"h6",children:"0 - 10 CU.M: "}),Object(a.jsx)("p",{className:"",children:"PHP 50.00"})]}),Object(a.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(a.jsx)("p",{className:"h6",children:"Above 10 CU.M: "}),Object(a.jsx)("p",{className:"",children:"PHP 11.00 / CU.M"})]}),Object(a.jsx)("div",{className:"d-flex justify-content-start",children:Object(a.jsx)("p",{className:"h6",children:"Others: "})})]}),Object(a.jsxs)("div",{className:"col-4 m-auto",children:[Object(a.jsx)("p",{className:"font-weight-bold text-right",children:"Amount"}),Object(a.jsx)("div",{className:"d-flex justify-content-end",children:Object(a.jsx)("p",{className:"",children:"50.00"})}),Object(a.jsx)("div",{className:"d-flex justify-content-end",children:Object(a.jsx)("p",{className:"",children:"".concat(t.chargePerAboveTen,".00")})}),Object(a.jsx)("div",{className:"d-flex justify-content-end",children:Object(a.jsx)("p",{className:"",children:"0.00"})})]})]}),Object(a.jsx)("hr",{className:"my-1"}),Object(a.jsx)("div",{className:"row g-1",children:Object(a.jsxs)("div",{className:"col-6 ml-auto d-flex justify-content-between",children:[Object(a.jsx)("p",{className:"h5",children:"Total Amount"}),Object(a.jsx)("p",{className:"h5",children:"PHP ".concat(t.totalAmountDue,".00")})]})})]}),Object(a.jsx)("div",{className:"card-footer",children:Object(a.jsx)("div",{className:"d-flex w-100 justify-content-end",children:Object(a.jsx)("button",{className:"btn btn-outline-primary btn-lg px-4",type:"button",onClick:function(){n.goBack()},children:"Go Back"})})})]})})})})}),A=function(e){var t=e.bills,c=e.viewBill,n=31556952e3,l=Object(s.useState)(1609364952e3),r=Object(m.a)(l,2),i=r[0],o=r[1],d=Object(s.useState)(t.sort((function(e,t){return t.billNumber-e.billNumber})).filter((function(e){return e.periodTo-i<n}))),b=Object(m.a)(d,2),j=b[0],u=b[1];return Object(s.useEffect)((function(){u(t.sort((function(e,t){return t.billNumber-e.billNumber})).filter((function(e){return e.periodTo-i<n})))}),[t,i,n]),Object(a.jsxs)("table",{className:"table table-hover table-striped text-center",children:[Object(a.jsx)("thead",{children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{scope:"col",children:"Bill No."}),Object(a.jsx)("th",{scope:"col",children:"Period Covered"}),Object(a.jsx)("th",{scope:"col",children:"Consumption"}),Object(a.jsx)("th",{scope:"col",children:"Amount"}),Object(a.jsx)("th",{scope:"col",children:Object(a.jsx)("select",{className:"form-select","aria-label":".form-select-lg example",onChange:function(e){o(e.target.value)},children:[{name:"2021",value:1609364952e3},{name:"2020",value:1577808e6},{name:"2019",value:1546272e6}].map((function(e){return Object(a.jsx)("option",{value:e.value,children:e.name},e.name)}))})})]})}),Object(a.jsx)("tbody",{children:0!==j.length?j.map((function(e,t){return Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{scope:"row",children:e.billNumber}),Object(a.jsx)("td",{children:"".concat(new Date(e.periodFrom).toDateString().substring(4,7),". ").concat(new Date(e.periodFrom).toDateString().substring(8,10)," - \n                  ").concat(new Date(e.periodTo).toDateString().substring(4,7),". ").concat(new Date(e.periodTo).toDateString().substring(8,10))}),Object(a.jsx)("td",{children:"".concat(e.cumUsed," Cu. Meters")}),Object(a.jsx)("td",{children:"PHP ".concat(e.totalAmountDue,".00")}),Object(a.jsx)("td",{className:"d-flex justify-content-around",children:Object(a.jsx)("button",{type:"button",className:"btn btn-sm btn-primary",onClick:function(e){c(e.target.value)},value:e.billNumber,children:"View Details"})})]},t)})):Object(a.jsx)("tr",{children:Object(a.jsx)("td",{colSpan:5,className:"py-4",children:Object(a.jsxs)("em",{children:["No Available Records for ",new Date(i).toDateString()]})})})})]})};function P(){return Object(a.jsxs)("div",{className:"d-flex w-100 align-items-center justify-content-center",style:{height:"50vh"},children:[Object(a.jsx)("div",{className:"spinner-grow mx-2",style:{width:"2.2rem",height:"2.2rem",animationDelay:"0.08s"},role:"status",children:Object(a.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),Object(a.jsx)("div",{className:"spinner-grow mx-3",style:{width:"3rem",height:"3rem",animationDelay:"0.16s"},role:"status",children:Object(a.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),Object(a.jsx)("div",{className:"spinner-grow mx-2",style:{width:"2.2rem",height:"2.2rem",animationDelay:"0.24s"},role:"status",children:Object(a.jsx)("span",{className:"visually-hidden",children:"Loading..."})})]})}var M=function(e){var t=e.endpoint,c=e.token,a=Object(s.useState)({data:null,loading:!0}),n=Object(m.a)(a,2),l=n[0],r=n[1],i=Object(s.useRef)(null);return Object(s.useEffect)((function(){i.current=new AbortController})),Object(s.useEffect)((function(){var e=i.current.signal;return r({data:null,loading:!0}),fetch("https://sp1-blue-sparrow.herokuapp.com/api/v1"+t,{method:"GET",headers:{"x-auth-token":c},signal:e}).then((function(e){return e.text()})).then((function(e){r({data:JSON.parse(e),loading:!1})})).catch((function(e){alert(e)})),function(){return i.current.abort()}}),[t,c]),l},I=function(){var e,t,c=localStorage.getItem("token"),n=u(c).account.accountNumber,l="/bill-management/bills/".concat(n),r=M({endpoint:l,token:c}).data,i=Object(o.g)(),d=Object(s.useContext)(S).setBillOnDisplay;return Object(a.jsxs)("div",{className:"container pt-2",children:[Object(a.jsx)("p",{className:"display-5 text-center py-3",children:"My Bills"}),Object(a.jsx)("div",{className:"row pt-2",children:Object(a.jsx)("div",{className:"col-12 col-md-10 m-auto",children:(e=r,t=function(e){var t=r.find((function(t){return t.billNumber===parseInt(e)}));d(t),i.push({pathname:"/customer/bills/".concat(e),state:{from:i.location}})},e?Object(a.jsx)(A,{bills:e,viewBill:t}):Object(a.jsx)(P,{}))})})]})},T=function(){var e=Object(o.h)().path,t=Object(s.useContext)(S).billOnDisplay;return Object(a.jsxs)(o.d,{children:[Object(a.jsx)(o.b,{exact:!0,path:e,children:Object(a.jsx)(I,{})}),Object(a.jsx)(o.b,{path:"".concat(e,"/:billNo"),children:Object(a.jsx)(k,{bill:t})})]})},B=function(e){var t=e.consumption,c=Object(s.useState)({}),a=Object(m.a)(c,2),n=a[0],l=a[1];return Object(s.useEffect)((function(){var e=t-10,c=e>0?11*e:0;l({chargeTenBelow:50,chargeAboveTen:c,total:50+c})}),[t]),n},R=(c(41),function(){var e,t=localStorage.getItem("token"),c=u(t).account.accountNumber,s="/account-management/accounts/".concat(c,"/account"),n=Object(o.g)(),l=M({endpoint:s,token:t}).data,r=B({consumption:null===l||void 0===l?void 0:l.lastBillReading}).total,i=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object(a.jsxs)("div",{className:"container customer-page-wrapper",children:[Object(a.jsxs)("div",{className:"row pt-3",children:[Object(a.jsx)("div",{className:"col-12 col-md-8",children:Object(a.jsx)("p",{className:"display-5",children:"My Account"})}),Object(a.jsx)("div",{className:"col-12 col-md-4 d-flex align-items-center justify-content-md-end",children:Object(a.jsxs)("p",{className:"h5",children:["Account No.: ",Object(a.jsx)("span",{className:"font-weight-lighter",children:c})]})})]}),(e=l,e?Object(a.jsxs)("dl",{className:"row pt-4",children:[Object(a.jsx)("dt",{className:"col-sm-3 h5",children:"Name"}),Object(a.jsx)("dd",{className:"col-sm-9",children:l.fullName}),Object(a.jsx)("dt",{className:"col-sm-3 h5",children:"Address"}),Object(a.jsx)("dd",{className:"col-sm-9",children:l.address?l.address:"No Address"}),Object(a.jsx)("dt",{className:"col-sm-3 h5",children:"Mobile No."}),Object(a.jsx)("dd",{className:"col-sm-9",children:void 0===l.mobileNumber?"No Mobile Number":"".concat(l.mobileNumber.substring(0,3)," ").concat(l.mobileNumber.substring(3,6),"-").concat(l.mobileNumber.substring(6,9),"-").concat(l.mobileNumber.substring(9))}),Object(a.jsx)("dt",{className:"col-sm-3 h5",children:"Meter Serial No."}),Object(a.jsx)("dd",{className:"col-sm-9",children:l.meterSerialNumber?l.meterSerialNumber:"NO METER SERIAL NO."}),Object(a.jsx)("hr",{className:"my-4"}),Object(a.jsx)("dt",{className:"col-12 pb-2 h5",children:"Most Recent Bill Details"}),Object(a.jsx)("dt",{className:"col-sm-3",children:"Month Covered"}),Object(a.jsx)("dd",{className:"col-sm-9",children:0===l.lastBillPeriodTo?"-":"".concat(i[new Date(l.lastBillPeriodTo).getMonth()-1],"-").concat(i[new Date(l.lastBillPeriodTo).getMonth()])}),Object(a.jsx)("dt",{className:"col-sm-3",children:"Meter Reading"}),Object(a.jsx)("dd",{className:"col-sm-9",children:0===l.lastBillReading?"-":"".concat(l.lastBillReading," Cu. Meters")}),Object(a.jsx)("dt",{className:"col-sm-3",children:"Amount Due"}),Object(a.jsx)("dd",{className:"col-sm-9",children:"Php ".concat(r,".00")}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{className:"btn btn-success btn-lg w-md-25 w-50 mt-3",type:"button",onClick:function(){n.push({pathname:"/customer/bills",state:{from:n.location}})},children:"View Bills"})})]}):Object(a.jsx)(P,{}))]})}),D=function(){var e=localStorage.getItem("token"),t=Object(s.useState)(0),c=Object(m.a)(t,2),n=c[0],l=c[1],r="https://sp1-blue-sparrow.herokuapp.com",i=Object(s.useState)(!1),o=Object(m.a)(i,2),b=o[0],j=o[1],u=Object(s.useState)({accounts:!1,statements:!1}),h=Object(m.a)(u,2),O=h[0],x=h[1];return Object(a.jsxs)("div",{className:"container h-100",children:[Object(a.jsx)("p",{className:"display-5 text-center py-3",children:"Reports"}),Object(a.jsxs)("div",{className:"row gy-4 flex-column",children:[Object(a.jsxs)("div",{className:"col-md-6",children:[Object(a.jsx)("span",{children:"Download All Accounts to Excel"}),Object(a.jsx)("button",{type:"button",className:"btn btn-primary mx-3",style:{width:"200px"},disabled:b,onClick:function(){x(Object(d.a)(Object(d.a)({},O),{},{accounts:!0})),j(!0),fetch(r+"/api/v1/reports-management/export/accounts/all",{method:"GET",headers:{"x-auth-token":e}}).then((function(e){e.blob().then((function(t){var c=window.URL.createObjectURL(t),a=document.createElement("a");a.href=c,a.download=e.headers.get("Content-Disposition").split("=")[1]||"AllAccounts.xlsx",a.click(),j(!1),x(Object(d.a)(Object(d.a)({},O),{},{accounts:!1}))}))})).catch((function(e){console.log(e),alert("There was a problem with your download. Refresh the page and try again."),j(!1),x(Object(d.a)(Object(d.a)({},O),{},{accounts:!1}))}))},children:O.accounts?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(a.jsx)("span",{className:"visually-hidden",children:"Downloading..."})]}):Object(a.jsx)("span",{children:"Download Accounts"})})]}),Object(a.jsx)("hr",{}),Object(a.jsxs)("div",{className:"col-md-6",children:["Download Statement of Accounts. Select a month to download.",Object(a.jsxs)("select",{className:"form-select my-3",defaultChecked:!0,disabled:b,onChange:function(e){l(e.target.value)},children:[Object(a.jsx)("option",{value:0,children:"January"}),Object(a.jsx)("option",{value:1,children:"February"}),Object(a.jsx)("option",{value:2,children:"March"}),Object(a.jsx)("option",{value:3,children:"April"}),Object(a.jsx)("option",{value:4,children:"May"}),Object(a.jsx)("option",{value:5,children:"June"}),Object(a.jsx)("option",{value:6,children:"July"}),Object(a.jsx)("option",{value:7,children:"August"}),Object(a.jsx)("option",{value:8,children:"September"}),Object(a.jsx)("option",{value:9,children:"October"}),Object(a.jsx)("option",{value:10,children:"November"}),Object(a.jsx)("option",{value:11,children:"December"})]}),Object(a.jsx)("button",{type:"button",className:"btn btn-primary",style:{width:"200px"},disabled:b,onClick:function(){!function(t){x(Object(d.a)(Object(d.a)({},O),{},{statements:!0})),j(!0);var c="/api/v1/reports-management/export/statements/".concat(t);fetch(r+c,{method:"GET",headers:{"x-auth-token":e}}).then((function(e){e.blob().then((function(t){var c=window.URL.createObjectURL(t),a=document.createElement("a");a.href=c,a.download=e.headers.get("Content-Disposition").split("=")[1]||"Statements.xlsx",a.click(),j(!1),x(Object(d.a)(Object(d.a)({},O),{},{statements:!1}))}))})).catch((function(e){console.log(e),alert("There was a problem with your download. Refresh the page and try again."),j(!1),x(Object(d.a)(Object(d.a)({},O),{},{statements:!1}))}))}(n)},children:O.statements?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(a.jsx)("span",{className:"visually-hidden",children:"Downloading..."})]}):Object(a.jsx)("span",{children:"Download Statements"})})]})]})]})},F=Object(s.createContext)(null),L=function(e){var t=e.children,c=Object(s.useState)([]),n=Object(m.a)(c,2),l=n[0],r=n[1];return Object(a.jsx)(F.Provider,{value:{accountList:l,setAccountList:r},children:t})},E=Object(s.createContext)(),V=function(e){var t=e.children,c=Object(s.useState)({}),n=Object(m.a)(c,2),l=n[0],r=n[1];return Object(a.jsx)(E.Provider,{value:{billAccount:l,setBillAccount:r},children:t})},U=function(e){var t=e.chargeOthers,c=e.chargePerAboveTen,s=e.cumUsed,n=e.dateStringIssued,l=e.dateStringFrom,r=e.dateStringTo,i=e.readingPresent,o=e.readingPrevious,d=e.totalAmountDue,b=function(e){var t=e.alignRight,c=e.name,s=e.value;return Object(a.jsxs)("div",{className:"col-md-5 d-flex w-100 mb-1 justify-content-between ".concat(t&&"ml-auto"),children:[Object(a.jsx)("span",{style:{fontWeight:"500"},children:"".concat(c||"-",":")}),s||"-"]})};return Object(a.jsxs)("div",{className:"row g-3 py-2",children:[Object(a.jsxs)("div",{className:"col-md-5 d-flex flex-column",children:[Object(a.jsx)(b,{name:"Present Reading",value:i&&i+"\u33a5"}),Object(a.jsx)(b,{name:"Previous Reading",value:o&&o+"\u33a5"}),Object(a.jsx)(b,{name:"Used",value:s&&s+"\u33a5"})]}),Object(a.jsxs)("div",{className:"col-md-5 d-flex flex-column ml-auto",children:[Object(a.jsx)(b,{name:"Date Issued",value:n,alignRight:!0}),Object(a.jsx)(b,{name:"From",value:l,alignRight:!0}),Object(a.jsx)(b,{name:"To",value:r,alignRight:!0})]}),Object(a.jsxs)("div",{className:"col-md-5 d-flex flex-column",children:[Object(a.jsx)("div",{style:{fontSize:"1.1rem"},children:"Rates"}),Object(a.jsx)(b,{name:"0\u33a5 to 10\u33a5",value:"Php 50.00"}),Object(a.jsx)(b,{name:"Succeeding 10\u33a5",value:"Php 11.00/\u33a5"})]}),Object(a.jsxs)("div",{className:"col-md-5 d-flex flex-column ml-auto",children:[Object(a.jsx)("div",{style:{fontSize:"1.1rem"},children:"Charges"}),Object(a.jsx)(b,{name:"0\u33a5 to 10\u33a5",value:"Php 50.00"}),Object(a.jsx)(b,{name:"Succeeding 10\u33a5",value:"Php ".concat(c||"0",".00")}),Object(a.jsx)(b,{name:"Other Charges:",value:"Php ".concat(t||"0",".00")})]}),Object(a.jsx)("div",{className:"col-md-5 d-flex flex-column ml-auto",children:Object(a.jsxs)("div",{className:"col-md-5 d-flex w-100 justify-content-between",children:[Object(a.jsx)("span",{style:{fontWeight:"500",fontSize:"1.15rem"},children:"Total Amount Due:"}),"Php ".concat(d||"0",".00")]})})]})},J=function(e){var t=e.account.bills,c=Object(s.useState)(Object.values(t)[0]||{}),n=Object(m.a)(c,2),l=n[0],r=n[1];return Object(a.jsxs)("div",{children:[Object(a.jsxs)("div",{className:"row align-items-center justify-content-center",children:[Object(a.jsx)("div",{className:"col-7 h5",children:"Statement Summary"}),Object(a.jsx)("div",{className:"col-5",children:Object.keys(t).length<=0?Object(a.jsx)("select",{className:"form-select","aria-label":"Select a statement period",disabled:!0,defaultChecked:!0,children:Object(a.jsx)("option",{children:"No Available Statements"})}):Object(a.jsx)("select",{className:"form-select","aria-label":"Select a statement period",defaultChecked:!0,onChange:function(e){r(t[e.target.value])},children:Object.keys(t).map((function(e){return Object(a.jsx)("option",{value:e,children:e},e)}))})})]}),Object(a.jsx)(U,Object(d.a)({},l))]})},G=(c(42),function(e){var t=e.account,c=e.setShowModal;function s(){c(!1)}return console.log(t),Object(a.jsx)("div",{className:"account-details-modal",children:Object(a.jsx)("div",{className:"modal-dialog modal-lg details-modal",children:Object(a.jsxs)("div",{className:"modal-content",children:[Object(a.jsxs)("div",{className:"modal-header",children:[Object(a.jsx)("p",{className:"modal-title h4",id:"account-details-modal",children:"Account No.: ".concat(t.accountNumber)}),Object(a.jsx)("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:s})]}),Object(a.jsxs)("div",{className:"modal-body p-4",children:[Object(a.jsxs)("div",{className:"row g-4",children:[Object(a.jsxs)("div",{className:"col-md-5 d-flex justify-content-between mr-auto",children:[Object(a.jsx)("span",{className:"font-weight-bold",children:"Full Name:"}),Object(a.jsx)("span",{children:t.fullName})]}),Object(a.jsxs)("div",{className:"col-md-5 d-flex justify-content-between",children:[Object(a.jsx)("span",{className:"font-weight-bold",children:"Address: "}),Object(a.jsxs)("span",{children:[" ",t.address," "]})]}),Object(a.jsxs)("div",{className:"col-md-5 d-flex justify-content-between mr-auto",children:[Object(a.jsx)("span",{className:"font-weight-bold",children:"Mobile No.: "}),Object(a.jsx)("span",{children:"0".concat(t.mobileNumber.substring(3,6),"-").concat(t.mobileNumber.substring(6,9),"-").concat(t.mobileNumber.substring(9))})]}),Object(a.jsxs)("div",{className:"col-md-5 d-flex justify-content-between",children:[Object(a.jsx)("span",{className:"font-weight-bold",children:"Meter Serial No.: "}),Object(a.jsxs)("span",{children:[" ",t.meterSerialNumber," "]})]})]}),Object(a.jsx)("hr",{className:"my-4"}),Object(a.jsx)(J,{account:t})]}),Object(a.jsx)("div",{className:"modal-footer",children:Object(a.jsx)("button",{type:"button",className:"btn btn-secondary",style:{width:"180px"},onClick:s,children:"Close"})})]})})})}),z=c(10),W=c(13),q=function(){return Object(a.jsxs)("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-trash",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[Object(a.jsx)("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}),Object(a.jsx)("path",{fillRule:"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4L4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"})]})},H=function(){return Object(a.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-chevron-down",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:Object(a.jsx)("path",{fillRule:"evenodd",d:"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"})})},Y=function(){return Object(a.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-chevron-up",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:Object(a.jsx)("path",{fillRule:"evenodd",d:"M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6z"})})},$=function(){return Object(a.jsxs)("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-chevron-double-left",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[Object(a.jsx)("path",{fillRule:"evenodd",d:"M8.354 1.646a.5.5 0 0 1 0 .708L2.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"}),Object(a.jsx)("path",{fillRule:"evenodd",d:"M12.354 1.646a.5.5 0 0 1 0 .708L6.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"})]})},_=function(){return Object(a.jsxs)("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-chevron-double-right",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[Object(a.jsx)("path",{fillRule:"evenodd",d:"M3.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L9.293 8 3.646 2.354a.5.5 0 0 1 0-.708z"}),Object(a.jsx)("path",{fillRule:"evenodd",d:"M7.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L13.293 8 7.646 2.354a.5.5 0 0 1 0-.708z"})]})},K=function(e){var t=e.columns;return Object(a.jsx)("colgroup",{children:t.map((function(e,t){return Object(a.jsx)("col",{style:{width:"".concat(e.width,"%")}},t)}))})},Q=function(e){var t=e.columns,c=e.setOrderBy,s=e.setDirection,n=e.arrow,l={asc:Object(a.jsx)(Y,{}),desc:Object(a.jsx)(H,{})};return Object(a.jsx)("thead",{children:Object(a.jsx)("tr",{children:t.map((function(e,t){return"actions"===e.id?Object(a.jsx)("th",{scope:"col",className:e.className},t):Object(a.jsx)("th",{scope:"col",className:e.className,children:Object(a.jsxs)("div",{className:"d-flex w-100 justify-content-between align-items-center py-2",style:{cursor:"pointer"},title:e.title||"",onClick:function(){c(e.id),s((function(e){return"asc"===e?"desc":"asc"}))},children:[Object(a.jsx)("div",{children:e.title||""}),n&&l[n[e.id]]]})},t)}))})})},X=function(e){var t=e.array,c=e.rows,s=e.emptyRows;return Object(a.jsxs)("tbody",{children:[t&&t.map((function(e,t){return Object(a.jsx)("tr",{children:(s=e,c.map((function(e,t){return 0===t?Object(a.jsx)("th",{scope:"row",className:e.className,children:s&&s[e.id]},e.id):"longDate"===e.type?Object(a.jsx)("td",{className:e.className,children:0===s[e.id]?"-":new Date(s[e.id]).toDateString().substring(4,7)},e.id):"barangay"===e.type?Object(a.jsx)("td",{className:e.className,children:s[e.id].split(",")[0]},e.id):"action"===e.type?Object(a.jsx)("td",{className:e.className,children:e.actions.map((function(e,t){return Object(a.jsx)("button",{className:"btn btn-sm ".concat(e.className),onClick:function(){e.callback(s)},children:e.label},t)}))},e.id):Object(a.jsx)("td",{className:e.className,children:s[e.id]},e.id)})))},e.id);var s})),function(){var e;if(s>0&&(e=Object(z.a)(Array(s).keys())),void 0!==e)return e.map((function(e){return Object(a.jsx)("tr",{style:{height:"2.9rem"},children:Object(a.jsx)("td",{className:"bg-paper",colSpan:c.length})},e)}))}()]})},Z=function(e){var t=e.length,c=e.pagination,s=e.setPagination,n=e.totalPages;return Object(a.jsx)("tfoot",{children:Object(a.jsx)("tr",{children:Object(a.jsx)("td",{colSpan:t,children:Object(a.jsx)("div",{className:"d-flex justify-content-center",children:Object(a.jsxs)("ul",{className:"pagination my-0",children:[Object(a.jsx)("li",{className:"page-item ".concat(c.pageNumber<=1&&"disabled"),style:{cursor:"".concat(c.pageNumber>1?"pointer":"default")},onClick:function(){if(c.pageNumber<=1)return!1;s(Object(d.a)(Object(d.a)({},c),{},{pageNumber:c.pageNumber-1}))},children:Object(a.jsx)("span",{className:"page-link","aria-hidden":!0,style:{color:"#3a3a3a"},children:Object(a.jsx)($,{})})}),Object(a.jsx)("li",{className:"page-item",style:{cursor:"default"},children:Object(a.jsxs)("span",{className:"page-link","aria-hidden":!0,style:{color:"#3a3a3a"},children:["No. of Rows",Object(a.jsx)("select",{className:"ml-1",style:{border:"0px"},"aria-label":"Rows Per Page",defaultChecked:!0,defaultValue:c.rowsPerPage,onChange:function(e){s(Object(d.a)(Object(d.a)({},c),{},{rowsPerPage:parseInt(e.target.value)}))},children:[5,10,25,50].map((function(e,t){return Object(a.jsx)("option",{value:e,children:e},t)}))})]})}),Object(a.jsx)("li",{className:"page-item",style:{cursor:"default"},children:Object(a.jsxs)("span",{className:"page-link","aria-hidden":!0,style:{color:"#3a3a3a"},children:["Page ",Object(a.jsx)("b",{children:c.pageNumber})," of ",Object(a.jsx)("b",{children:n})]})}),Object(a.jsx)("li",{className:"page-item ".concat(c.pageNumber>=n&&"disabled"),style:{cursor:"".concat(c.pageNumber<n?"pointer":"default")},onClick:function(){if(c.pageNumber>=n)return!1;s(Object(d.a)(Object(d.a)({},c),{},{pageNumber:c.pageNumber+1}))},children:Object(a.jsx)("span",{className:"page-link","aria-hidden":!0,style:{color:"#3a3a3a"},children:Object(a.jsx)(_,{})})})]})})})})})},ee=function(e){var t=e.rows,c=e.columns,n=e.data,l=Object(s.useState)(n.length>0&&Object.keys(n[0])[1]),r=Object(m.a)(l,2),i=r[0],o=r[1],d=Object(s.useState)("asc"),b=Object(m.a)(d,2),j=b[0],u=b[1],h=Object(s.useState)({rowsPerPage:10,pageNumber:1}),O=Object(m.a)(h,2),x=O[0],p=O[1],f=function(e){var t=e.data,c=e.orderBy,a=e.direction,n=Object(s.useState)({sortedArray:Object(z.a)(t),sortArrow:null}),l=Object(m.a)(n,2),r=l[0],i=l[1];return Object(s.useEffect)((function(){i("asc"===a?{sortedArray:Object(z.a)(t).sort((function(e,t){return"number"!==typeof e[c]?e[c]>t[c]?1:t[c]>e[c]?-1:0:e[c]-t[c]})),sortArrow:Object(W.a)({},c,a)}:{sortedArray:Object(z.a)(t).sort((function(e,t){return"number"!==typeof e[c]?e[c]<t[c]?1:t[c]<e[c]?-1:0:t[c]-e[c]})),sortArrow:Object(W.a)({},c,a)})}),[t,a,c]),r}({data:n,orderBy:i,direction:j}),N=f.sortedArray,v=f.sortArrow,g=function(e){var t=e.data,c=e.rowsPerPage,a=e.pageNumber,n=Object(s.useState)({currentPage:null,totalPages:0,emptyRows:0}),l=Object(m.a)(n,2),r=l[0],i=l[1];return Object(s.useEffect)((function(){var e=a*c,s=e-c,n=e-t.length;i({currentPage:Object(z.a)(t).slice(s,e),totalPages:Math.round(t.length/c+.5),emptyRows:n<0?0:n})}),[t,c,a]),r}({data:N,rowsPerPage:x.rowsPerPage,pageNumber:x.pageNumber}),y=g.currentPage,w=g.totalPages,S=g.emptyRows;return Object(a.jsxs)("table",{className:"table table-hover table-striped w-100 align-middle",children:[Object(a.jsx)(K,{columns:c}),Object(a.jsx)(Q,{columns:c,setOrderBy:o,setDirection:u,arrow:v}),Object(a.jsx)(X,{array:y,rows:t,emptyRows:S}),Object(a.jsx)(Z,{length:t.length,pagination:x,setPagination:p,totalPages:w})]})},te=c(21),ce=c.n(te),ae=c(25),se=function(){var e=Object(ae.a)(ce.a.mark((function e(t,c){var a,s;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/account-management/accounts/delete/",e.prev=1,e.next=4,fetch("https://sp1-blue-sparrow.herokuapp.com/api/v1/account-management/accounts/delete/"+c,{method:"DELETE",headers:{"x-auth-token":t}});case 4:a=e.sent,e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),a="error";case 11:if(e.prev=11,"error"===a){e.next=16;break}return e.next=15,a.text();case 15:s=e.sent;case 16:e.next=22;break;case 18:e.prev=18,e.t1=e.catch(11),console.log(e.t1),s="error";case 22:return e.abrupt("return",s);case 23:case"end":return e.stop()}}),e,null,[[1,7],[11,18]])})));return function(t,c){return e.apply(this,arguments)}}(),ne=function(){var e=localStorage.getItem("token"),t=M({endpoint:"/account-management/accounts/bills/all",token:e}).data,c=Object(s.useContext)(F),n=c.accountList,l=c.setAccountList;Object(s.useEffect)((function(){t&&l(t)}),[t,l]);var r=Object(s.useState)(!1),i=Object(m.a)(r,2),o=i[0],d=i[1],b=Object(s.useState)({}),j=Object(m.a)(b,2),u=j[0],h=j[1],O=Object(s.useState)(!1),x=Object(m.a)(O,2),p=x[0],f=x[1],N=Object(s.useState)(""),v=Object(m.a)(N,2),y=v[0],w=v[1],S=Object(s.useState)(!1),C=Object(m.a)(S,2),k=C[0],A=C[1],I=Object(s.useState)({title:"Delete Account",message:"Please be reminded that once deleted, all account information, including old statements, cannot be restored. \n\nPress 'Confirm' to continue."}),T=Object(m.a)(I,2),B=T[0],R=T[1];var D,L,E,V,U,J,z=[{id:"accountNumber",type:"string",className:""},{id:"fullName",type:"string",className:""},{id:"address",type:"barangay",className:""},{id:"actions",type:"action",className:"text-center",actions:[{label:"".concat(window.innerWidth<768?"View":"View Details"),className:"btn-primary px-2 mx-1",callback:function(e){d(!0),h(e)}},{label:Object(a.jsx)(q,{}),className:"btn-danger m-2 text-center",callback:function(e){f(!0),w(e.accountNumber)}}]}];return Object(a.jsxs)("div",{className:"container h-100",children:[(D=B.title,L=B.message,E=function(){f(!1),R({title:"Delete Account",message:"Please be reminded that once deleted, all account information, including old statements, cannot be restored. \n\nPress 'Confirm' to continue."})},V=function(t){A(!0),se(e,t).then((function(e){"ACCOUNT DELETED"===e&&(A(!1),R({title:"Success",message:"Account with Account No. ".concat(t," has been deleted.")})),l(n.filter((function(e){return e.accountNumber!==t})))})).catch((function(e){console.log(e),A(!1),R({title:"Failed",message:"There was a problem deleting this account. \n\nRefresh the page and try again."})}))},U=y,J=k,p&&Object(a.jsx)(g,{title:D,message:L,hide:E,confirmAction:V,refNumber:U,loading:J})),o&&Object(a.jsx)(G,{account:u,setShowModal:d}),Object(a.jsx)("p",{className:"display-5 text-center py-3",children:"Accounts"}),t&&n?Object(a.jsx)("div",{className:"row pt-2",children:Object(a.jsx)("div",{className:"col-12 col-md-10 m-auto",children:Object(a.jsx)(ee,{columns:[{id:"accountNumber",title:"Account No.",width:"17",className:"my-0 py-0"},{id:"fullName",title:"Full Name",width:"22",className:"my-0 py-0"},{id:"address",title:"Barangay",width:"16",className:"my-0 py-0"},{id:"actions",title:"",width:"19",className:""}],rows:z,data:n})})}):Object(a.jsx)("div",{className:"row py-4 h-50",children:Object(a.jsx)(P,{})})]})},le=(c(44),function(e){var t=e.values,c=e.setValues,n=e.errors;var l=Object(s.useState)("form-control"),r=Object(m.a)(l,2),i=r[0],o=r[1];return Object(s.useEffect)((function(){n.accountNumber?o("form-control is-invalid"):o("form-control")}),[n]),Object(a.jsxs)("div",{className:"col-md-6",children:[Object(a.jsx)("label",{htmlFor:"accountNumberId",className:"form-label",children:"Account Number"}),Object(a.jsx)("input",{type:"text",className:i,id:"accountNumberId",placeholder:"ex. 2020-00-01",value:t.accountNumber||"",onChange:function(e){/^[0-9 -]*$/.test(e.target.value)?c(Object(d.a)(Object(d.a)({},t),{},{accountNumber:e.target.value.trim()})):e.target.value.trim()}}),Object(a.jsx)("div",{className:"invalid-feedback",children:n.accountNumber||""})]})}),re=function(e){var t=e.errors,c=Object(s.useState)("form-control"),n=Object(m.a)(c,2),l=n[0],r=n[1];return Object(s.useEffect)((function(){t.address?r("form-control is-invalid"):r("form-control")}),[t]),Object(a.jsxs)("div",{className:"col-md-6",children:[Object(a.jsx)("label",{htmlFor:"addressId",className:"form-label",children:"Address"}),Object(a.jsx)("input",{type:"text",className:l,id:"addressId",value:"Alcantara, Romblon",disabled:!0}),Object(a.jsx)("div",{className:"invalid-feedback",children:t.address||""})]})},ie=function(e){var t=e.values,c=e.setValues,n=e.errors;var l=Object(s.useState)("form-control"),r=Object(m.a)(l,2),i=r[0],o=r[1];return Object(s.useEffect)((function(){n.fullName?o("form-control is-invalid"):o("form-control")}),[n]),Object(a.jsxs)("div",{className:"col-md-6",children:[Object(a.jsx)("label",{htmlFor:"fullNameId",className:"form-label",children:"Full Name"}),Object(a.jsx)("input",{type:"text",className:i,id:"fullNameId",placeholder:"ex. Juan Dela Cruz",value:t.fullName||"",onChange:function(e){c(Object(d.a)(Object(d.a)({},t),{},{fullName:e.target.value}))}}),Object(a.jsx)("div",{className:"invalid-feedback",children:n.fullName||""})]})},oe=function(e){var t=e.values,c=e.setValues,n=e.errors;var l=Object(s.useState)("form-control"),r=Object(m.a)(l,2),i=r[0],o=r[1];return Object(s.useEffect)((function(){n.meterSerialNumber?o("form-control is-invalid"):o("form-control")}),[n]),Object(a.jsxs)("div",{className:"col-md-6",children:[Object(a.jsx)("label",{htmlFor:"meterSerialNumberId",className:"form-label",children:"Meter Serial Number"}),Object(a.jsx)("input",{type:"text",className:i,id:"meterSerialNumberId",placeholder:"ex. EVJ 64352341",value:t.meterSerialNumber||"",onChange:function(e){c(Object(d.a)(Object(d.a)({},t),{},{meterSerialNumber:e.target.value}))}}),Object(a.jsx)("div",{className:"invalid-feedback",children:n.meterSerialNumber||""})]})},de=function(e){var t=e.values,c=e.setValues,n=e.errors;var l=Object(s.useState)("form-control"),r=Object(m.a)(l,2),i=r[0],o=r[1];return Object(s.useEffect)((function(){n.mobileNumber?o("form-control is-invalid"):o("form-control")}),[n]),Object(a.jsxs)("div",{className:"col-md-6",children:[Object(a.jsx)("label",{htmlFor:"mobileNumberId",className:"form-label",children:"Mobile Number"}),Object(a.jsx)("input",{type:"text",className:i,id:"mobileNumberId",placeholder:"ex. 9179876543",value:t.mobileNumber||"",onChange:function(e){/^([+0]63)?[0-9]*$/.test(e.target.value)&&e.target.value.length<14&&e.target.value.length>=3?c(Object(d.a)(Object(d.a)({},t),{},{mobileNumber:e.target.value})):e.target.value.trim()}}),Object(a.jsx)("div",{className:"invalid-feedback",children:n.mobileNumber||""})]})},be=function(e){var t=e.values,c=e.setValues,s=[{label:"Poblacion",value:"POB"},{label:"Gui-ob",value:"GUI"},{label:"Madalag",value:"MAD"},{label:"Bagsik",value:"BAG"},{label:"Lawan",value:"LAW"},{label:"Camili",value:"CAM"},{label:"San Isidro",value:"SNI"},{label:"San Roque",value:"SNR"},{label:"Tugdan",value:"TUG"},{label:"Calagonsao",value:"CAL"},{label:"Bonlao",value:"BON"},{label:"Comod-om",value:"COM"}],n={POB:"Poblacion",GUI:"Gui-ob",MAD:"Madalag",BAG:"Bagsik",LAW:"Lawan",CAM:"Camili",SNI:"San Isidro",SNR:"San Roque",TUG:"Tugdan",CAL:"Calagonsao",BON:"Bonlao",COM:"Comod-om"};return Object(a.jsxs)("div",{className:"col-md-6",children:[Object(a.jsx)("label",{htmlFor:"barangayId",className:"form-label",children:"Barangay"}),Object(a.jsx)("select",{id:"barangayId",className:"form-select",defaultChecked:!0,defaultValue:s[0].value,onChange:function(e){c(Object(d.a)(Object(d.a)({},t),{},{barangay:e.target.value,address:"".concat(n["".concat(e.target.value)],", Alcantara, Romblon")})),console.log(n["".concat(e.target.value)])},children:s.map((function(e){return Object(a.jsx)("option",{value:e.value,children:e.label},e.label)}))})]})},je=function(e){var t=e.values,c=e.setValues;return Object(a.jsxs)("div",{className:"col-md-12",children:[Object(a.jsx)("p",{className:"form-check-label text-center font-weight-bold",children:"Select if Account is New or Existing"}),Object(a.jsxs)("div",{className:"col-md-12 d-flex justify-content-center",children:[Object(a.jsxs)("div",{className:"form-check form-check-inline mx-5",children:[Object(a.jsx)("input",{className:"form-check-input",type:"radio",name:"newOrExistingAccountOptions",id:"newAccountId",value:!1,checked:!t.existing,onChange:function(){c(Object(d.a)(Object(d.a)({},t),{},{existing:!1,lastBillNumber:0,lastBillReading:0,lastBillPeriodTo:0}))}}),Object(a.jsx)("label",{className:"form-check-label",htmlFor:"newAccountId",children:"New"})]}),Object(a.jsxs)("div",{className:"form-check form-check-inline mx-5",children:[Object(a.jsx)("input",{className:"form-check-input",type:"radio",name:"newOrExistingAccountOptions",id:"existingAccountId",value:!0,checked:t.existing,onChange:function(){c(Object(d.a)(Object(d.a)({},t),{},{existing:!0,lastBillPeriodTo:15801408e5}))}}),Object(a.jsx)("label",{className:"form-check-label",htmlFor:"existingAccountId",children:"Existing"})]})]})]})},me=function(e){var t=e.values,c=e.setValues,n=e.errors,l=Object(s.useState)("form-control"),r=Object(m.a)(l,2),i=r[0],o=r[1],b=Object(s.useState)("form-control"),j=Object(m.a)(b,2),u=j[0],h=j[1];return Object(s.useEffect)((function(){n.lastBillNumber?o((function(e){return"form-control is-invalid"})):o((function(e){return"form-control"})),n.lastBillReading?h((function(e){return"form-control is-invalid"})):h((function(e){return"form-control"}))}),[n]),Object(a.jsxs)("div",{className:"row g-3",children:[Object(a.jsx)("p",{className:"font-weight-bold  my-0 py-0",children:"Most Recent Bill Details:"}),Object(a.jsxs)("div",{className:"col-md-3",children:[Object(a.jsx)("label",{htmlFor:"lastBillNumberId",className:"form-label",children:"Bill Number"}),Object(a.jsx)("input",{type:"number",className:i,id:"lastBillNumberId",onChange:function(e){c(Object(d.a)(Object(d.a)({},t),{},{lastBillNumber:e.target.value}))}}),Object(a.jsx)("div",{className:"invalid-feedback",children:n.lastBillNumber||""})]}),Object(a.jsxs)("div",{className:"col-md-3",children:[Object(a.jsx)("label",{htmlFor:"lastBillReadingId",className:"form-label",children:"Reading"}),Object(a.jsx)("input",{type:"number",className:u,id:"lastBillReadingId",onChange:function(e){c(Object(d.a)(Object(d.a)({},t),{},{lastBillReading:e.target.value}))}}),Object(a.jsx)("div",{className:"invalid-feedback",children:n.lastBillReading||""})]}),Object(a.jsxs)("div",{className:"col-md-3",children:[Object(a.jsx)("label",{htmlFor:"lastBillYearId",className:"form-label",children:"Year"}),Object(a.jsx)("select",{id:"lastBillYearId",className:"form-select",children:Object(a.jsx)("option",{value:1577808e6,defaultChecked:!0,children:"2020"})})]}),Object(a.jsxs)("div",{className:"col-md-3",children:[Object(a.jsx)("label",{htmlFor:"lastBillPeriodToId",className:"form-label",children:"Month"}),Object(a.jsx)("select",{id:"lastBillPeriodToId",className:"form-select",defaultChecked:!0,onChange:function(e){c(Object(d.a)(Object(d.a)({},t),{},{lastBillPeriodTo:e.target.value}))},children:[{label:"January",value:15801408e5},{label:"February",value:15828192e5},{label:"March",value:15853248e5},{label:"April",value:15880032e5},{label:"May",value:15905952e5},{label:"June",value:15932736e5},{label:"July",value:15958656e5},{label:"August",value:1598544e6},{label:"September",value:16012224e5},{label:"October",value:16038144e5},{label:"November",value:16064928e5},{label:"December",value:16090848e5}].map((function(e){return Object(a.jsx)("option",{value:e.value,children:e.label},e.label)}))})]})]})},ue=function(e){var t=e.values,c=e.errors,s=e.setErrors,n=e.setLoading,l=e.setShowModal,r=localStorage.getItem("token");return Object(a.jsx)("div",{className:"col-md-12 d-flex justify-content-center py-3",children:Object(a.jsx)("button",{type:"button",className:"btn btn-primary w-50",onMouseDown:function(){s(function(e){var t,c={};return e.accountNumber||(c.accountNumber="Account Number is required"),/^[0-9]{4}(-[0-9]{2})\-?[0-9]+/.test(e.accountNumber)||(c.accountNumber="Invalid format (valid ex. 2016-09-03)"),e.fullName||(c.fullName="Full Name is required"),e.mobileNumber||(c.mobileNumber="Mobile Number is required"),/^([+0]63)?[9]{1}[0-9]{9}$/.test(e.mobileNumber)||(c.mobileNumber="Invalid mobile number (valid ex. +639065338541)"),(null===(t=e.mobileNumber)||void 0===t?void 0:t.length)<13&&(c.mobileNumber="Mobile Number is too short"),e.address||(c.address="Address is required"),e.meterSerialNumber||(c.meterSerialNumber="Meter Serial Number is required"),e.existing&&(e.lastBillNumber||(c.lastBillNumber="Bill Number is required"),e.lastBillReading||(c.lastBillReading="Reading is required")),c}(t))},onMouseUp:function(e){if(Object.keys(c).length>0)return!1;console.log("SENDING"),n(!0),fetch("https://sp1-blue-sparrow.herokuapp.com/api/v1/account-management/accounts/create",{method:"POST",headers:{"Content-type":"application/json","x-auth-token":r},body:JSON.stringify(t)}).then((function(e){return e.text()})).then((function(e){n(!1),"Success"===e?l(!0):s("Account Number Already Taken"===e?Object(d.a)(Object(d.a)({},c),{},{accountNumber:e}):Object(d.a)(Object(d.a)({},c),{},{meterSerialNumber:e}))})).catch((function(e){console.log(e),alert("Something went wrong..."),n(!1)}))},children:"Submit"})})},he=(c(45),function(e){var t=e.setShowModal,c=e.setValues,s=Object(o.g)();function n(){c({accountNumber:"",meterSerialNumber:"",fullName:"",mobileNumber:"+63",barangay:"POB",address:"Poblacion, Alcantara, Romblon",existing:!1,lastBillNumber:0,lastBillReading:0,lastBillPeriodTo:0}),t(!1)}return Object(a.jsx)("div",{className:"success-modal",children:Object(a.jsx)("div",{className:"modal-dialog modal-dialog-centered",children:Object(a.jsxs)("div",{className:"modal-content",children:[Object(a.jsxs)("div",{className:"modal-header",children:[Object(a.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Submission Successful"}),Object(a.jsx)("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:n})]}),Object(a.jsxs)("div",{className:"modal-body",children:[Object(a.jsx)("p",{children:"Account has been successfully created!"}),Object(a.jsx)("p",{children:"Go to Accounts page to view the newly created account or continue and create another account."})]}),Object(a.jsxs)("div",{className:"modal-footer",children:[Object(a.jsx)("button",{type:"button",className:"btn btn-outline-primary",onClick:function(){t(!1),s.push("/admin/accounts")},children:"View Accounts"}),Object(a.jsx)("button",{type:"button",className:"btn btn-primary",onClick:n,children:"Continue"})]})]})})})}),Oe=function(){var e=Object(s.useState)({barangay:"POB",address:"Poblacion, Alcantara, Romblon",mobileNumber:"+63",existing:!1,lastBillNumber:0,lastBillReading:0,lastBillPeriodTo:0}),t=Object(m.a)(e,2),c=t[0],n=t[1],l=Object(s.useState)({}),r=Object(m.a)(l,2),i=r[0],o=r[1],d=Object(s.useState)(!1),b=Object(m.a)(d,2),j=b[0],u=b[1],h=Object(s.useState)(!1),O=Object(m.a)(h,2),x=O[0],p=O[1];return Object(a.jsxs)("div",{className:"container col-md-8",children:[x&&Object(a.jsx)(he,{setShowModal:p,setValues:n}),Object(a.jsx)("p",{className:"display-5 text-center py-3",children:j?"Submitting Account Information":"Account Registration"}),j?Object(a.jsxs)("div",{className:"row",children:[Object(a.jsx)(P,{}),Object(a.jsx)("p",{className:"display-6 text-center",children:"Please wait"})]}):Object(a.jsxs)("form",{className:"row g-3 pb-4",children:[Object(a.jsx)(je,{values:c,setValues:n}),Object(a.jsx)(le,{values:c,setValues:n,errors:i}),Object(a.jsx)(oe,{values:c,setValues:n,errors:i}),Object(a.jsx)(ie,{values:c,setValues:n,errors:i}),Object(a.jsx)(de,{values:c,setValues:n,errors:i}),Object(a.jsx)(be,{values:c,setValues:n}),Object(a.jsx)(re,{errors:i}),c.existing&&Object(a.jsx)(me,{values:c,setValues:n,errors:i}),Object(a.jsx)(ue,{values:c,errors:i,setErrors:o,setLoading:u,setShowModal:p})]})]})},xe=function(){var e=Object(o.h)().path;return Object(a.jsx)(L,{children:Object(a.jsx)(V,{children:Object(a.jsxs)(o.d,{children:[Object(a.jsx)(o.b,{exact:!0,path:e,children:Object(a.jsx)(ne,{})}),Object(a.jsx)(o.b,{path:"".concat(e,"/new"),children:Object(a.jsx)(Oe,{})})]})})})},pe=(c(46),function(e){var t=e.cardImg,c=e.cardTitle,s=e.cardText,n=e.buttonLabel,l=e.handleClick,r=s.split(".");return Object(a.jsx)("div",{className:"col-md-4",children:Object(a.jsxs)("div",{className:"card h-100 p-2",children:[Object(a.jsx)("img",{src:t,className:"card-img-top",alt:"...",style:{objectFit:"contain",height:"150px"}}),Object(a.jsxs)("div",{className:"card-body",children:[Object(a.jsx)("h5",{className:"card-title pb-2",children:c}),Object(a.jsx)("div",{className:"card-text",children:r.map((function(e,t){return Object(a.jsx)("div",{className:"pb-1",children:e},t)}))})]}),Object(a.jsx)("div",{className:"card-footer",children:Object(a.jsx)("button",{type:"button",className:"btn btn-primary w-100 my-1",onClick:l,children:n})})]})})}),fe=c.p+"static/media/register.c0fea52c.png",Ne=c.p+"static/media/accounts.15c1b769.png",ve=c.p+"static/media/statement.a5d35e3b.jpg",ge=function(){var e=Object(s.useState)(!0),t=Object(m.a)(e,2),c=t[0],n=t[1];Object(s.useEffect)((function(){var e=setTimeout((function(){n(!1)}),1400);return function(){return clearTimeout(e)}}),[]);var l=Object(o.h)().path,r=Object(o.g)(),i=[{id:"addAccountId",cardImg:fe,cardTitle:"Create an account",cardText:"Accounts from the old system can be registered in this system. New accounts can also be registered easily. Click the button below to learn more.",buttonLabel:"Go to Registration Page",handleClick:function(){return r.push(l+"/accounts/new")}},{id:"viewAccountsId",cardImg:Ne,cardTitle:"View registered accounts",cardText:"All accounts can be viewed in a table format, which also comes with sorting features. The sorting can be toggled by clicking a column header. Click the button below to see.",buttonLabel:"Go to Accounts Page",handleClick:function(){return r.push(l+"/accounts")}},{id:"issueStatementsId",cardImg:ve,cardTitle:"Issue a new statement",cardText:"The system will only be needing the current meter reading. All the other values will be auto-computed and account holders will be notified through SMS.",buttonLabel:"Go to Statements Page",handleClick:function(){return r.push(l+"/statements")}}],d=window.innerWidth;return Object(a.jsx)("div",{className:"container",children:c?Object(a.jsx)(P,{}):Object(a.jsxs)("div",{children:[Object(a.jsxs)("div",{className:"row d-flex w-100 justify-content-around align-items-center my-3",style:{height:"".concat(d<576?"100vh":"75vh")},children:[Object(a.jsx)("div",{className:"text-center col-md-4",children:Object(a.jsx)("img",{src:f,alt:"Alcantara, Romblon - Municipal Seal",className:"img-thumbnail border-0",style:{height:"15rem",width:"15rem"}})}),Object(a.jsxs)("div",{className:"col-md-8",children:[Object(a.jsx)("p",{className:"h2",children:"Municipality of Alcantara"}),Object(a.jsx)("p",{className:"display-6",children:"Integrated Water Supply System"}),Object(a.jsxs)("p",{className:"text-justify",children:["Our goal is to improve distribution of monthly water bills, while also adding convenience by allowing the account holders to view their bills and account details online.",Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),"The monthly distribution of bills will be covered by our system's integrated SMS notification feature. Account holders can view their accounts by logging in to our customer's page."]})]})]}),Object(a.jsxs)("div",{className:"row card-group my-4 py-4",children:[Object(a.jsx)("p",{className:"h2 mb-3 text-center",children:"Main Features"}),i.map((function(e){return Object(a.jsx)(pe,{cardImg:e.cardImg,cardTitle:e.cardTitle,cardText:e.cardText,buttonLabel:e.buttonLabel,handleClick:e.handleClick},e.id)}))]})]})})},ye=Object(s.createContext)(null),we=function(e){var t=e.children,c=Object(s.useState)([]),n=Object(m.a)(c,2),l=n[0],r=n[1];return Object(a.jsx)(ye.Provider,{value:{accounts:l,setAccounts:r},children:t})},Se=function(){return Object(s.useContext)(ye)},Ce=c(1),ke=Ce.createContext,Ae=Ce.useContext,Pe=ke(),Me=function(e){var t=e.children;return Object(a.jsx)(Pe.Provider,{value:[{label:"December 28 - January 28",short:"12/28/20 - 01/28/21",value:{periodFrom:16090848e5,periodTo:16117632e5}},{label:"January 28 - February 28",short:"01/28/21 - 02/28/21",value:{periodFrom:16117632e5,periodTo:16144416e5}},{label:"February 28 - March 28",short:"02/28/21 - 03/28/21",value:{periodFrom:16144416e5,periodTo:16168608e5}},{label:"March 28 - April 28",short:"03/28/21 - 04/28/21",value:{periodFrom:16168608e5,periodTo:16195392e5}},{label:"April 28 - May 28",short:"04/28/21 - 05/28/21",value:{periodFrom:16195392e5,periodTo:16221312e5}},{label:"May 28 - June 28",short:"05/28/21 - 06/28/21",value:{periodFrom:16221312e5,periodTo:16248096e5}},{label:"June 28 - July 28",short:"06/28/21 - 07/28/21",value:{periodFrom:16248096e5,periodTo:16274016e5}},{label:"July 28 - August 28",short:"07/28/21 - 08/28/21",value:{periodFrom:16274016e5,periodTo:163008e7}},{label:"August 28 - September 28",short:"08/28/21 - 09/28/21",value:{periodFrom:163008e7,periodTo:16327584e5}},{label:"September 28 - October 28",short:"09/28/21 - 10/28/21",value:{periodFrom:16327584e5,periodTo:16353504e5}},{label:"October 28 - November 28",short:"10/28/21 - 11/28/21",value:{periodFrom:16353504e5,periodTo:16380288e5}},{label:"November 28 - December 28",short:"11/28/21 - 12/28/21",value:{periodFrom:16380288e5,periodTo:16406208e5}}],children:t})},Ie=function(){return Ae(Pe)},Te=(c(47),function(e){var t=e.payload,c=e.account,s=e.isLoading,n=e.setIsLoading,l=e.errors,r=e.setErrors,i=e.setShowModal,o=localStorage.getItem("token"),d=Se(),b=d.accounts,j=d.setAccounts;return Object(a.jsx)("button",{type:"button",className:"btn btn-success col-md-3 col-8",onMouseDown:function(){r(function(e,t){var c={};return e.accountNumber||(c.accountNumber="Account number is required for issuing."),e.periodFrom||(c.periodFrom="You must select the period covered for this statement."),"number"!==typeof e.periodFrom&&(c.periodFrom="A valid statement period must be selected."),e.periodTo||(c.periodTo="You must select the period covered for this statement."),"number"!==typeof e.periodTo&&(c.periodTo="A valid statement period must be selected."),e.readingPresent||(c.readingPresent="Present Meter Reading is required. Please try again."),e.readingPresent<t.lastBillReading&&(c.readingPresent="Present Meter Reading should not be less than previous reading."),c}(t,c))},onMouseUp:function(){if(n(!0),Object.keys(l).length>0)return n(!1),!1;fetch("https://sp1-blue-sparrow.herokuapp.com/api/v1/bill-management/bills/issue",{method:"POST",headers:{"Content-type":"application/json","x-auth-token":o},body:JSON.stringify(t)}).then((function(e){return e.text()})).then((function(e){"FIRST"!==e&&"SUCCEEDING"!==e||(n(!1),j(b.filter((function(e){return e.accountNumber!==t.accountNumber}))),alert("Statement was successfully issued. Click Ok to continue."),i(!1))})).catch((function(e){console.log(e),alert("Oops.. Something went wrong..."),n(!1)}))},disabled:s,children:s?Object(a.jsxs)("span",{children:[Object(a.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(a.jsx)("span",{className:"visually-hidden",children:"Loading..."})]}):Object(a.jsx)("span",{children:"Submit New Statement"})})}),Be=function(e){var t=e.payload,c=e.setPayload,n=e.setShowModal,l=Se().accounts.find((function(e){return e.accountNumber===t.accountNumber})),r=Ie().find((function(e){return e.value.periodTo===t.periodTo})),i=B({consumption:t.readingPresent-((null===l||void 0===l?void 0:l.lastBillReading)||0)}),o=Object(s.useState)(!1),b=Object(m.a)(o,2),j=b[0],u=b[1];function h(){c(Object(d.a)(Object(d.a)({},t),{},{accountNumber:"",readingPresent:0,chargeOthers:0})),n(!1)}var O=Object(s.useState)(!1),x=Object(m.a)(O,2),p=x[0],f=x[1],N=Object(s.useState)({}),v=Object(m.a)(N,2),g=v[0],y=v[1],w=window.innerWidth;return Object(a.jsx)("div",{className:"new-bill-modal",children:Object(a.jsx)("div",{className:"modal-dialog modal-xl modal-fullscreen-md-down",children:Object(a.jsxs)("div",{className:"modal-content",children:[Object(a.jsxs)("div",{className:"modal-header d-flex flex-column",children:[Object(a.jsx)("button",{type:"button",className:"btn-close",onClick:h,"aria-label":"Close",disabled:p}),Object(a.jsxs)("div",{className:"row align-items-center justify-content-around w-100",children:[Object(a.jsxs)("div",{className:"col-md-4",children:[Object(a.jsx)("p",{className:"m-0 p-0 text-center ",children:"Account No."}),Object(a.jsx)("p",{className:"m-0 p-0 text-center font-weight-bold font-l",children:(null===l||void 0===l?void 0:l.accountNumber)||"-"})]}),Object(a.jsx)("p",{className:"font-3xl m-0 p-0 text-center col-md-4",children:"Statement of Account"}),Object(a.jsxs)("div",{className:"col-md-4",children:[Object(a.jsx)("p",{className:"m-0 p-0 text-center ",children:"Period Covered"}),Object(a.jsx)("p",{className:"m-0 p-0 text-center font-weight-bold font-l",children:r.short||"-"})]})]})]}),Object(a.jsx)("div",{className:"modal-body",children:Object(a.jsxs)("div",{className:"container",children:[Object(a.jsxs)("div",{className:"row bg-paper py-2 my-1",children:[Object(a.jsxs)("div",{className:"col-md-4",children:[Object(a.jsx)("p",{className:"m-0 p-0 text-center mb-1",children:"Name"}),Object(a.jsx)("p",{className:"m-0 p-0 text-center font-l",children:(null===l||void 0===l?void 0:l.fullName)||"-"})]}),Object(a.jsxs)("div",{className:"col-md-4",children:[Object(a.jsx)("p",{className:"m-0 p-0 text-center mb-1",children:"Address"}),Object(a.jsx)("p",{className:"m-0 p-0 text-center font-l",children:(null===l||void 0===l?void 0:l.address)||"-"})]}),Object(a.jsxs)("div",{className:"col-md-4",children:[Object(a.jsx)("p",{className:"m-0 p-0 text-center mb-1",children:"Meter Serial No."}),Object(a.jsx)("p",{className:"m-0 p-0 text-center font-l",children:(null===l||void 0===l?void 0:l.meterSerialNumber)||"-"})]})]}),Object(a.jsxs)("div",{className:"row bg-paper py-2 my-1 meter-reading-section",children:[Object(a.jsx)("div",{className:"col-12",children:Object(a.jsx)("p",{className:"m-0 p-0 text-center font-xl font-weight-bold",children:"Meter Reading"})}),Object(a.jsxs)("div",{className:"col-md-4",children:[Object(a.jsx)("p",{className:"m-0 p-0 text-center ",children:"Previous"}),Object(a.jsx)("div",{className:"d-flex flex-column justify-content-center ",children:Object(a.jsx)("p",{className:"m-0 p-0 text-center font-l",children:"".concat((null===l||void 0===l?void 0:l.lastBillReading)||"0"," Cu. M")})})]}),Object(a.jsxs)("div",{className:"col-md-4",children:[Object(a.jsx)("p",{className:"m-0 p-0 text-center font-weight-bold",children:"Present"}),Object(a.jsxs)("div",{className:"row align-items-center justify-content-center ",children:[Object(a.jsx)("div",{className:"col-3 mr-1",children:Object(a.jsx)("div",{className:"row align-items-center",children:Object(a.jsx)("input",{type:"number",id:"readingPresent",className:"form-control form-control-sm text-right","aria-describedby":"readingPresent",value:t.readingPresent||"",onChange:function(e){e.target.value.length<=4&&e.target.value>=0?c(Object(d.a)(Object(d.a)({},t),{},{readingPresent:parseInt(e.target.value)})):e.target.value.trim()},disabled:p})})}),Object(a.jsx)("p",{className:"m-0 p-0 font-weight-bold font-l col-3 ml-1",children:"Cu. M"})]})]}),Object(a.jsxs)("div",{className:"col-md-4",children:[Object(a.jsx)("p",{className:"m-0 p-0 text-center ",children:"Cu. Meters Used"}),Object(a.jsx)("div",{className:"d-flex flex-column justify-content-center ",children:Object(a.jsx)("p",{className:"m-0 p-0 text-center font-l",children:"".concat(t.readingPresent-(null===l||void 0===l?void 0:l.lastBillReading)>0?t.readingPresent-(null===l||void 0===l?void 0:l.lastBillReading):"0"," Cu. M")})})]})]}),Object(a.jsxs)("div",{className:"row bg-paper pt-1 mt-1 pb-0 mb-0",children:[Object(a.jsx)("div",{className:"col-12",children:Object(a.jsx)("p",{className:"m-0 p-0 my-1 text-center font-xl font-weight-bold",children:"Consumption"})}),Object(a.jsxs)("div",{className:"col-md-4 col-5",children:[Object(a.jsx)("p",{className:"m-0 p-0 text-center mb-1",children:"Charges"}),Object(a.jsxs)("div",{className:"col-md-10 ml-auto font-l",children:[Object(a.jsx)("p",{className:"m-0 p-0 text-justify",children:"".concat(w<768?"0-10m\xb3":"0 to 10 Cu. Meters (m\xb3)")}),Object(a.jsx)("p",{className:"m-0 p-0 text-justify",children:"".concat(w<768?"Above 10m\xb3":"In Excess of 10 Cu. Meters (m\xb3)")})]})]}),Object(a.jsxs)("div",{className:"col-md-4 col-7",children:[Object(a.jsx)("p",{className:"m-0 p-0 text-center mb-1",children:"Rate"}),Object(a.jsxs)("div",{className:"row font-l",children:[Object(a.jsxs)("div",{className:"col-12 d-flex justify-content-center",children:[Object(a.jsx)("p",{className:"m-0 p-0 text-right pr-3 col-6",children:"".concat(w<768?"P":"Php")}),Object(a.jsx)("p",{className:"m-0 p-0 text-left col-6",children:"50.00"})]}),Object(a.jsxs)("div",{className:"col-12 d-flex justify-content-center",children:[Object(a.jsx)("p",{className:"m-0 p-0 text-right pr-3 col-6",children:"".concat(w<768?"P":"Php")}),Object(a.jsx)("p",{className:"m-0 p-0 text-left col-6",children:"".concat(w<768?"11.00/m\xb3":"11.00 / Cu. M")})]})]})]}),Object(a.jsxs)("div",{className:"col-md-4",children:[Object(a.jsx)("p",{className:"m-0 p-0 text-center mb-1",children:"Amount"}),Object(a.jsxs)("div",{className:"row font-l",children:[Object(a.jsxs)("div",{className:"col-10 d-flex justify-content-center",children:[Object(a.jsx)("p",{className:"m-0 p-0 text-right pr-4 font-weight-bold col-5",children:"Php"}),Object(a.jsx)("p",{className:"m-0 p-0 text-right pl-2 font-weight-bold col-3",children:"50.00"})]}),Object(a.jsxs)("div",{className:"col-10 d-flex justify-content-center",children:[Object(a.jsx)("p",{className:"m-0 p-0 text-right pr-4 font-weight-bold col-5",children:"Php"}),Object(a.jsx)("p",{className:"m-0 p-0 text-right pl-2 font-weight-bold col-3",children:"".concat((new Intl.NumberFormat).format(i.chargeAboveTen),".00")})]})]})]})]}),Object(a.jsxs)("div",{className:"row bg-paper other-charge-class",children:[Object(a.jsx)("div",{className:"col-md-4 font-l",children:Object(a.jsxs)("div",{className:"col-md-10 form-check m-0 p-0 ml-auto",children:[Object(a.jsx)("input",{className:"form-check-input",type:"checkbox",id:"otherChargeCheck",value:j,defaultChecked:j,onChange:function(e){return u(!j)},disabled:p}),Object(a.jsx)("label",{className:"form-check-label",htmlFor:"otherChargeCheck",children:"Other Charges"})]})}),Object(a.jsx)("div",{className:"col-md-4 ml-auto",children:Object(a.jsx)("div",{className:"d-flex flex-column justify-content-center ",children:Object(a.jsx)("p",{className:"m-0 p-0 text-center",children:"-"})})}),Object(a.jsx)("div",{className:"col-md-4",children:j?Object(a.jsxs)("div",{className:"row align-items-center justify-content-center",children:[Object(a.jsx)("p",{className:"m-0 p-0 text-right pr-3 font-weight-bold col-2 font-l",children:"Php"}),Object(a.jsx)("div",{className:"col-3",children:Object(a.jsx)("div",{className:"row align-items-center",children:Object(a.jsx)("input",{type:"number",id:"chargeOthers",className:"form-control form-control-sm text-right","aria-describedby":"passwordHelpInline",value:t.chargeOthers||0,onChange:function(e){e.target.value.length<=5&&e.target.value>=0?c(Object(d.a)(Object(d.a)({},t),{},{chargeOthers:parseInt(e.target.value)})):e.target.value.trim()},disabled:p})})})]}):Object(a.jsx)("div",{className:"row",children:Object(a.jsxs)("div",{className:"col-10 d-flex justify-content-center font-l",children:[Object(a.jsx)("p",{className:"m-0 p-0 text-right pr-4 col-5",children:"Php"}),Object(a.jsx)("p",{className:"m-0 p-0 text-right pl-2 col-3",children:"0.00"})]})})})]}),Object(a.jsxs)("div",{className:"row",children:[Object(a.jsx)("p",{className:"font-xxl m-0 p-0 col-md-4 text-center ml-auto font-weight-bold",children:"Total Amount Due"}),Object(a.jsx)("p",{className:"m-0 p-0 pl-2 font-weight-bold col-md-4 text-center font-xxl",children:"Php ".concat((new Intl.NumberFormat).format(i.total),".00")})]})]})}),Object(a.jsxs)("div",{className:"modal-footer",children:[Object(a.jsx)("p",{className:"col-6 text-center text-danger font-weight-bold",children:Object(a.jsx)("em",{children:g.readingPresent&&"*".concat(g.readingPresent)})}),Object(a.jsx)("button",{type:"button",className:"btn btn-outline-secondary col-md-2 col-4",onClick:h,disabled:p,children:"Close"}),Object(a.jsx)(Te,{payload:t,account:l,isLoading:p,setIsLoading:f,errors:g,setErrors:y,setShowModal:n})]})]})})})},Re=function(e){var t=e.payload,c=e.setPayload,s=e.monthIndex,n=Ie();return Object(a.jsxs)("div",{className:"row py-4",children:[Object(a.jsx)("div",{className:"col-md-5 pt-1",children:Object(a.jsx)("p",{className:"font-3xl text-right p-0 m-0",children:"Select Statement Period:"})}),Object(a.jsx)("div",{className:"col-md-4 mr-auto",children:Object(a.jsx)("select",{className:"form-select form-select-lg mb-3 ","aria-label":"period select",defaultChecked:!0,defaultValue:s,onChange:function(e){c(Object(d.a)(Object(d.a)({},t),{},{periodFrom:n[e.target.value].value.periodFrom,periodTo:n[e.target.value].value.periodTo}))},children:n&&n.map((function(e,t){return t>s-2&&t<s+3&&Object(a.jsx)("option",{value:t,children:e.label},t)}))})})]})},De=new Date,Fe=function(){var e=localStorage.getItem("token"),t=M({endpoint:"/account-management/accounts",token:e}).data,c=Se(),n=c.accounts,l=c.setAccounts,r=De.getMonth()<1?0:De.getMonth()-1,i=Ie(),o=Object(s.useState)({accountNumber:"",periodFrom:i[r].value.periodFrom,periodTo:i[r].value.periodTo,readingPresent:0,chargeOthers:0,issuedBy:102}),b=Object(m.a)(o,2),j=b[0],u=b[1],h=Object(s.useState)(!1),O=Object(m.a)(h,2),x=O[0],p=O[1];Object(s.useEffect)((function(){t&&l(t)}),[t,l]);var f=function(e){var t=e.data,c=e.filter,a=Object(s.useState)({filteredArr:Object(z.a)(t)}),n=Object(m.a)(a,2),l=n[0],r=n[1];return Object(s.useEffect)((function(){var e=t.filter((function(e){return e.lastBillPeriodTo<c}));r({filteredArr:e})}),[t,c]),l}({data:n||[],filter:j.periodTo}).filteredArr;var N=[{id:"accountNumber",type:"string",className:""},{id:"fullName",type:"string",className:""},{id:"address",type:"barangay",className:""},{id:"actions",type:"action",className:"text-center",actions:[{label:"".concat(window.innerWidth<768?"Issue":"Issue Statement"),className:"btn-primary px-2 mx-1",callback:function(e){u(Object(d.a)(Object(d.a)({},j),{},{accountNumber:e.accountNumber})),p(!0)}}]}];return Object(a.jsxs)("div",{className:"container",children:[x&&Object(a.jsx)(Be,{payload:j,setPayload:u,setShowModal:p}),Object(a.jsx)("p",{className:"display-5 text-center py-3",children:"Issue Statements"}),Object(a.jsx)(Re,{payload:j,setPayload:u,monthIndex:r}),t?Object(a.jsx)(ee,{columns:[{id:"accountNumber",title:"Account No.",width:"25",className:"my-0 py-0"},{id:"fullName",title:"Name",width:"30",className:"my-0 py-0"},{id:"address",title:"Barangay",width:"25",className:"my-0 py-0"},{id:"actions",title:"",width:"20",className:""}],rows:N,data:f}):Object(a.jsx)(P,{})]})},Le=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Ee=["January","February","March","April","May","June","July","August","September","October","November","December"],Ve=function(){var e=Object(o.g)(),t=Object(o.h)().path,c=function(){var e=Object(s.useState)(null),t=Object(m.a)(e,2),c=t[0],a=t[1],n=Object(s.useRef)(null);return Object(s.useEffect)((function(){n.current=new Date})),Object(s.useEffect)((function(){var e=Le[n.current.getDay()],t=Ee[n.current.getMonth()],c=n.current.getDate(),s=n.current.getFullYear();a("".concat(e,", ").concat(t," ").concat(c,", ").concat(s))}),[]),c}();return Object(a.jsx)("div",{className:"container",children:Object(a.jsx)("div",{className:"row",children:Object(a.jsxs)("div",{className:"col-md-8 mx-auto",children:[Object(a.jsx)("p",{className:"display-5 text-center py-3 pb-5",children:"Statements"}),Object(a.jsxs)("div",{className:"row g-4",children:[Object(a.jsxs)("div",{style:{fontSize:"1.5rem"},className:"my-3 col-md-10 mr-auto",children:[Object(a.jsx)("span",{children:"Today is "}),Object(a.jsxs)("span",{children:[" ",c&&c," "]})]}),Object(a.jsxs)("div",{className:"my-2",children:[Object(a.jsx)("span",{className:"font-xl",children:"Important Reminders:"}),Object(a.jsxs)("ul",{className:"mt-3",children:[Object(a.jsx)("li",{children:"After submitting the new statement, an SMS message will be sent to the mobile number of the account holder to inform them of their new bill."}),Object(a.jsx)("li",{children:"Do not forget to verify all the details before issuing a new statement."}),Object(a.jsx)("li",{children:"Please note that only the unbilled accounts for the selected statement period will be shown in the list."}),Object(a.jsx)("li",{children:"The available options for the statement period depends on current date."}),Object(a.jsx)("li",{children:"Statements cannot be issued for months that are past the available statement period options."}),Object(a.jsx)("li",{children:"Begin by pressing the button below."})]})]})]}),Object(a.jsx)("div",{className:"col py-2 text-center",children:Object(a.jsx)("button",{className:"btn btn-lg btn-outline-success col-md-6",type:"button",onClick:function(){e.push("".concat(t,"/issue"))},children:"Begin Issuing Statements"})})]})})})},Ue=function(){var e=Object(o.h)().path;return Object(a.jsx)(we,{children:Object(a.jsx)(Me,{children:Object(a.jsxs)(o.d,{children:[Object(a.jsx)(o.b,{exact:!0,path:e,children:Object(a.jsx)(Ve,{})}),Object(a.jsx)(o.b,{path:"".concat(e,"/issue"),children:Object(a.jsx)(Fe,{})})]})})})},Je=function(){var e=Object(o.g)(),t=localStorage.getItem("role"),c=Object(s.useState)(!1),n=Object(m.a)(c,2),l=n[0],r=n[1];Object(s.useEffect)((function(){r("admin"===t)}),[t]);var i=Object(s.useState)(!1),b=Object(m.a)(i,2),j=b[0],u=b[1],h={title:"Sign Out Confirmation",hide:function(){u(!1)},loading:!1,message:"Are you sure you want to sign out?",confirmAction:function(){e.push("/login"),localStorage.clear()}};return Object(a.jsxs)("div",{className:"h-100 pt-5 my-3",style:{maxWidth:"1200px",margin:"0 auto"},children:[j&&Object(a.jsx)(g,Object(d.a)({},h)),Object(a.jsx)(v,{signOut:u}),l?Object(a.jsxs)(o.d,{children:[Object(a.jsx)(o.b,{exact:!0,path:"/admin",children:Object(a.jsx)(ge,{})}),Object(a.jsx)(o.b,{path:"/admin/accounts",children:Object(a.jsx)(xe,{})}),Object(a.jsx)(o.b,{path:"/admin/statements",children:Object(a.jsx)(Ue,{})}),Object(a.jsx)(o.b,{path:"/admin/reports",children:Object(a.jsx)(D,{})})]}):Object(a.jsx)(w,{children:Object(a.jsx)(C,{children:Object(a.jsxs)(o.d,{children:[Object(a.jsx)(o.b,{exact:!0,path:"/customer",children:Object(a.jsx)(R,{})}),Object(a.jsx)(o.b,{path:"/customer/bills",children:Object(a.jsx)(T,{})})]})})})]})},Ge=function(e){var t=e.children,c=Object(b.a)(e,["children"]),n=Object(o.g)(),l=localStorage.getItem("role");return console.log(l),Object(s.useEffect)((function(){switch(l){case"admin":n.push("/admin");break;case"customer":n.push("/customer");break;default:n.push("/login")}}),[l,n]),Object(a.jsxs)(o.d,{children:[Object(a.jsx)(o.b,Object(d.a)(Object(d.a)({},c),{},{path:"/admin",render:function(e){return t}})),Object(a.jsx)(o.b,Object(d.a)(Object(d.a)({},c),{},{path:"/customer",render:function(e){return t}}))]})};var ze=function(){return Object(a.jsx)(i.a,{basename:"",children:Object(a.jsx)(x,{children:Object(a.jsxs)(o.d,{children:[Object(a.jsx)(o.b,{path:"/login",render:function(){return Object(a.jsx)(N,{})}}),Object(a.jsx)(j,{path:"/",children:Object(a.jsx)(Ge,{children:Object(a.jsx)(Je,{})})})]})})})},We=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,49)).then((function(t){var c=t.getCLS,a=t.getFID,s=t.getFCP,n=t.getLCP,l=t.getTTFB;c(e),a(e),s(e),n(e),l(e)}))};r.a.render(Object(a.jsx)(n.a.StrictMode,{children:Object(a.jsx)(ze,{})}),document.getElementById("root")),We()}},[[48,1,2]]]);
//# sourceMappingURL=main.615282f5.chunk.js.map